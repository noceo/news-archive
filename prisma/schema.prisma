// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Publisher {
  id            BigInt                @id @default(autoincrement())
  name          String                @db.VarChar(20)
  authors       AuthorsOnPublishers[]

  @@unique([name])
}

model Author {
  id            BigInt                @id @default(autoincrement())
  firstname     String                @db.VarChar(20)
  lastname      String                @db.VarChar(50)
  articles      Article[]
  publishers    AuthorsOnPublishers[]
}

model AuthorsOnPublishers {
  publisher     Publisher   @relation(fields: [publisherId], references: [id])
  publisherId   BigInt
  author        Author      @relation(fields: [authorId], references: [id])
  authorId      BigInt

  @@id([publisherId, authorId])
}

model Article {
  id            BigInt                  @id @default(autoincrement())
  title         String
  subline       String?
  copy          String
  Author        Author?                 @relation(fields: [authorId], references: [id])
  authorId      BigInt?
  categories    CategoriesOnArticles[]
}

model Category {
  id            BigInt                  @id @default(autoincrement())
  name          String                  @db.VarChar(10)
  articles      CategoriesOnArticles[]

  @@unique([name])
}

model CategoriesOnArticles {
  category      Category   @relation(fields: [categoryId], references: [id])
  categoryId    BigInt
  article       Article    @relation(fields: [articleId], references: [id])
  articleId     BigInt

  @@id([categoryId, articleId])
}
